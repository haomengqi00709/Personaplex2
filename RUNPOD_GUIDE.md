# RunPod éƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: åˆ›å»º RunPod Pod

1. ç™»å½• [RunPod](https://www.runpod.io/)
2. åˆ›å»ºæ–°çš„ Pod
3. é€‰æ‹© GPU:
   - **æœ€ä½é…ç½®**: RTX 3090 (24GB) æˆ– A4000 (16GB)
   - **æ¨èé…ç½®**: A100 (40GB/80GB) æˆ– RTX 4090 (24GB)
4. é€‰æ‹©æ¨¡æ¿: **PyTorch 2.0+** æˆ– **CUDA 11.8+**

### æ­¥éª¤ 2: è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨ RunPod Pod è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š

```
HF_TOKEN=your_huggingface_token_here
```

**å¦‚ä½•è·å– HF_TOKEN:**
1. è®¿é—® https://huggingface.co/settings/tokens
2. åˆ›å»ºæ–°çš„ Access Tokenï¼ˆéœ€è¦ Read æƒé™ï¼‰
3. è®¿é—® https://huggingface.co/nvidia/personaplex-7b-v1
4. æ¥å—æ¨¡å‹è®¸å¯åè®®
5. å¤åˆ¶ Token åˆ° RunPod ç¯å¢ƒå˜é‡

### æ­¥éª¤ 3: ä¸Šä¼ é¡¹ç›®æ–‡ä»¶

**æ–¹æ³• A: ä½¿ç”¨ Git**
```bash
cd /workspace
git clone <your-repo-url>
cd Personaplex2
```

**æ–¹æ³• B: ä½¿ç”¨ RunPod æ–‡ä»¶ç®¡ç†å™¨**
1. åœ¨ RunPod æ§åˆ¶å°æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨
2. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶åˆ° `/workspace/Personaplex2/`

### æ­¥éª¤ 4: å®‰è£…ä¾èµ–

```bash
cd /workspace/Personaplex2
pip install -r requirements.txt
```

æˆ–è€…ä½¿ç”¨æä¾›çš„è®¾ç½®è„šæœ¬ï¼š
```bash
chmod +x runpod_setup.sh
./runpod_setup.sh
```

### æ­¥éª¤ 5: è¿è¡Œæµ‹è¯•

**å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èï¼‰:**
```bash
python quick_test.py
```

**å®Œæ•´æµ‹è¯•:**
```bash
python test_personaplex.py
```

## ğŸ“Š é¢„æœŸç»“æœ

### æˆåŠŸè¾“å‡ºç¤ºä¾‹

```
============================================================
PersonaPlex å¿«é€Ÿæµ‹è¯•
============================================================

============================================================
ç¯å¢ƒæ£€æŸ¥
============================================================
âœ… CUDA å¯ç”¨
   GPU: NVIDIA A100-SXM4-40GB
   æ˜¾å­˜: 40.00 GB
âœ… HF_TOKEN å·²è®¾ç½®
âœ… Hugging Face è®¤è¯æˆåŠŸ

============================================================
åŠ è½½æ¨¡å‹
============================================================
æ¨¡å‹ ID: nvidia/personaplex-7b-v1
ä½¿ç”¨ float16 ä»¥é™ä½æ˜¾å­˜å ç”¨...

1. åŠ è½½å¤„ç†å™¨...
âœ… å¤„ç†å™¨åŠ è½½æˆåŠŸ

2. åŠ è½½æ¨¡å‹...
âœ… ä½¿ç”¨ MoshiForConditionalGeneration åŠ è½½æˆåŠŸ

æ˜¾å­˜ä½¿ç”¨: 14.23 GB / 15.50 GB

============================================================
æ¨ç†æµ‹è¯•
============================================================
æ–‡æœ¬æç¤º: You are a helpful AI assistant. Say hello in a friendly way.
æµ‹è¯•éŸ³é¢‘: 24000 é‡‡æ ·ç‚¹ (1.0ç§’, 24000Hz)

å¤„ç†è¾“å…¥...
æ‰§è¡Œæ¨ç†...

âœ… æ–‡æœ¬è¾“å‡º: Hello! How can I help you today?

âœ… æ¨ç†æµ‹è¯•æˆåŠŸï¼

============================================================
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
============================================================
```

## âš™ï¸ é…ç½®ä¼˜åŒ–

### æœ€ä½æ˜¾å­˜é…ç½®ï¼ˆ16GB VRAMï¼‰

ç¼–è¾‘ `config.yaml`:
```yaml
model:
  torch_dtype: "float16"  # å¿…é¡»ä½¿ç”¨ float16
  low_cpu_mem_usage: true

inference:
  max_new_tokens: 256     # å‡å°‘ç”Ÿæˆé•¿åº¦
```

### æ€§èƒ½ä¼˜åŒ–é…ç½®ï¼ˆ24GB+ VRAMï¼‰

```yaml
model:
  torch_dtype: "bfloat16"  # å¦‚æœæ”¯æŒï¼Œä½¿ç”¨ bfloat16
  low_cpu_mem_usage: true

inference:
  max_new_tokens: 512
  temperature: 0.7
```

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ˜¾å­˜ä¸è¶³ (CUDA OOM)

**é”™è¯¯ä¿¡æ¯:**
```
RuntimeError: CUDA out of memory
```

**è§£å†³æ–¹æ¡ˆ:**
1. ä½¿ç”¨æ›´å¤§çš„ GPUï¼ˆ24GB+ï¼‰
2. ç¡®ä¿ä½¿ç”¨ `float16` è€Œä¸æ˜¯ `float32`
3. å‡å° `max_new_tokens` å€¼
4. å…³é—­å…¶ä»–å ç”¨æ˜¾å­˜çš„ç¨‹åº

### é—®é¢˜ 2: Hugging Face è®¤è¯å¤±è´¥

**é”™è¯¯ä¿¡æ¯:**
```
401 Client Error: Unauthorized
```

**è§£å†³æ–¹æ¡ˆ:**
1. ç¡®è®¤ `HF_TOKEN` ç¯å¢ƒå˜é‡å·²è®¾ç½®
2. ç¡®è®¤ Token æœ‰æ•ˆä¸”æœ‰ Read æƒé™
3. ç¡®è®¤å·²æ¥å—æ¨¡å‹è®¸å¯åè®®
4. å°è¯•é‡æ–°ç™»å½•: `huggingface-cli login`

### é—®é¢˜ 3: æ¨¡å‹ä¸‹è½½å¤±è´¥

**é”™è¯¯ä¿¡æ¯:**
```
ConnectionError: Failed to download
```

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. ä½¿ç”¨ Hugging Face é•œåƒï¼ˆå¦‚æœåœ¨ä¸­å›½å¤§é™†ï¼‰
3. æ‰‹åŠ¨ä¸‹è½½æ¨¡å‹åˆ°æœ¬åœ°ç¼“å­˜

### é—®é¢˜ 4: å¯¼å…¥é”™è¯¯

**é”™è¯¯ä¿¡æ¯:**
```
ModuleNotFoundError: No module named 'transformers'
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
pip install --upgrade transformers torch
```

## ğŸ’° æˆæœ¬ä¼°ç®—

åŸºäº RunPod å®šä»·ï¼ˆ2024å¹´ï¼‰:

| GPU ç±»å‹ | æ˜¾å­˜ | æ¯å°æ—¶ä»·æ ¼ | æµ‹è¯•æ—¶é—´ | é¢„ä¼°æˆæœ¬ |
|---------|------|-----------|---------|---------|
| RTX 3090 | 24GB | ~$0.29 | ~5åˆ†é’Ÿ | ~$0.02 |
| RTX 4090 | 24GB | ~$0.69 | ~5åˆ†é’Ÿ | ~$0.06 |
| A100 40GB | 40GB | ~$1.79 | ~3åˆ†é’Ÿ | ~$0.09 |
| A100 80GB | 80GB | ~$2.99 | ~3åˆ†é’Ÿ | ~$0.15 |

**æç¤º**: æµ‹è¯•å®Œæˆåè®°å¾—åœæ­¢ Pod ä»¥èŠ‚çœæˆæœ¬ï¼

## ğŸ“ ä¸‹ä¸€æ­¥

æµ‹è¯•æˆåŠŸåï¼Œä½ å¯ä»¥ï¼š

1. **è‡ªå®šä¹‰è§’è‰²æç¤º**: ä¿®æ”¹ `text_prompt` æ¥æ”¹å˜ AI çš„è§’è‰²
2. **ä½¿ç”¨çœŸå®éŸ³é¢‘**: å‡†å¤‡ 24kHz WAV æ–‡ä»¶è¿›è¡Œæµ‹è¯•
3. **æµå¼å¤„ç†**: å®ç°å®æ—¶éŸ³é¢‘æµå¤„ç†
4. **API æœåŠ¡**: å°†æ¨¡å‹éƒ¨ç½²ä¸º Web API

## ğŸ”— æœ‰ç”¨é“¾æ¥

- [RunPod æ–‡æ¡£](https://docs.runpod.io/)
- [PersonaPlex æ¨¡å‹é¡µé¢](https://huggingface.co/nvidia/personaplex-7b-v1)
- [PersonaPlex GitHub](https://github.com/NVIDIA/personaplex)
- [Hugging Face æ–‡æ¡£](https://huggingface.co/docs/transformers/)

